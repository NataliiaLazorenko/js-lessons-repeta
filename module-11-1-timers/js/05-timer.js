/*
 * –ü–∏—à–µ–º–æ —Ç–∞–π–º–µ—Ä
 */

// 1. –ë–µ—Ä–µ–º–æ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫–Ω–æ–ø–∫–∏ —Ç–∞ –∞–±–∑–∞—Ü, –≤ —è–∫–æ–º—É –±—É–¥–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏—Å—è —Ç–∞–π–º–µ—Ä
const refs = {
  startBtn: document.querySelector('button[data-action-start]'),
  stopBtn: document.querySelector('button[data-action-stop]'),
  clockface: document.querySelector('.js-clockface'),
};

// 2. –°—Ç–≤–æ—Ä—é—î–º–æ –æ–±'—î–∫—Ç —Ç–∞–π–º–µ—Ä–∞
const timer = {
  // 17. –©–æ–± –∑—É–ø–∏–Ω–∏—Ç–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª, –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –π–æ–≥–æ id. –°—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –≥–ª–æ–±–∞–ª—å–Ω—É –∑–º—ñ–Ω–Ω—É –¥–æ—Å–∏—Ç—å –¥–∏–≤–Ω–æ. –û—Å–∫—ñ–ª—å–∫–∏ timer —Ü–µ –æ–±'—î–∫—Ç, –¥–æ–¥–∞—î–º–æ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å intervalId
  intervalId: null,
  // 22. –°—Ç–≤–æ—Ä—é—î–º–æ —Å–≤–æ—î—Ä—ñ–¥–Ω–∏–π –ø—Ä–∞–ø–æ—Ä–µ—Ü—å, —è–∫–∏–π –±—É–¥–µ —Ñ—ñ–∫—Å—É–≤–∞—Ç–∏ —á–∏ –∞–∫—Ç–∏–≤–Ω–∏–π —Ç–∞–π–º–µ—Ä. –ü–æ—Ç—Ä—ñ–±–µ–Ω, —â–æ–± –Ω–µ –º–æ–∂–Ω–∞ –±—É–ª–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–æ –∫—ñ–ª—å–∫–∞ —Ç–∞–π–º–µ—Ä—ñ–≤
  isActive: false,

  // 3. –î–æ–¥–∞—î–º–æ –º–µ—Ç–æ–¥ start - –∫–æ–ª–∏ –Ω–∞—Ç–∏—Å–∫–∞—î–º–æ –Ω–∞ –∫–Ω–æ–ø–∫—É start, —Ç–∞–π–º–µ—Ä –º–∞—î –ø–æ—á–∞—Ç–∏ —Ä–∞—Ö—É–≤–∞—Ç–∏ —á–∞—Å
  start() {
    // 24. –Ø–∫—â–æ —Ç–∞–π–º–µ—Ä –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ, –≤–∏—Ö–æ–¥–∏–º–æ —ñ–∑ —Ñ—É–Ω–∫—Ü—ñ—ó (–º–æ–∂–Ω–∞ –±—É–ª–æ –± –≤—ñ–¥–∫–ª—é—á–∏—Ç–∏ –∫–Ω–æ–ø–∫—É (–∑—Ä–æ–±–∏—Ç–∏ disabled), –∞–ª–µ —Ç–æ–¥—ñ –ø—Ä–æ–≥—Ä–∞–º–Ω–æ —Ç–∞–π–º–µ—Ä –º–æ–∂–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–∏)
    if (this.isActive) {
      return;
    }
    // 23. –í–∫–∞–∑—É—î–º–æ, —â–æ —Ç–∞–π–º–µ—Ä –∞–∫—Ç–∏–≤–Ω–∏–π (–∑–∞–ø—É—â–µ–Ω–æ)
    this.isActive = true;
    // 5. –ü–æ—Ç—Ä—ñ–±–Ω–æ –∫–æ–∂–Ω–æ—ó —Å–µ–∫—É–Ω–¥–∏ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—Ç–∏ –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ –ø–æ—Ç–æ—á–Ω–∏–º —á–∞—Å–æ–º —ñ —Å—Ç–∞—Ä—Ç–æ–≤–∏–º. –¢–æ–º—É –∑–∞–ø–∏—Å—É—î–º–æ —É –∑–º—ñ–Ω–Ω—É –ø–æ—Ç–æ—á–Ω–∏–π —á–∞—Å –Ω–∞ –º–æ–º–µ–Ω—Ç –∑–∞–ø—É—Å–∫—É –º–µ—Ç–æ–¥—É start (—Å—Ç–∞—Ä—Ç–æ–≤–∏–π —á–∞—Å)
    const startTime = Date.now();

    // 26. –¢–∞–π–º–µ—Ä –ø–æ—á–∏–Ω–∞—î –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ —á–∞—Å –∑ 1-—ó —Å–µ–∫—É–Ω–¥–∏ (00:00:01). –ü–µ—Ä–µ–¥–∞—î–º–æ —É —Ñ—É–Ω–∫—Ü—ñ—é updateClockface —á–∞—Å 0, —â–æ–± —Ç–∞–π–º–µ—Ä –Ω–µ —á–µ–∫–∞–≤ —Å–µ–∫—É–Ω–¥—É, –∞ —Å—Ç–∞—Ä—Ç—É–≤–∞–≤ –∑ 00:00:00
    updateClockface(0);

    // 4. –í–∏–∫–ª–∏–∫–∞—î–º–æ setInterval, —è–∫–∏–π —Ä–µ—î—Å—Ç—Ä—É—î –≤—ñ–¥–∫–ª–∞–¥–µ–Ω–∏–π –≤–∏–∫–ª–∏–∫ —Ñ—É–Ω–∫—Ü—ñ—ó —â–æ—Å–µ–∫—É–Ω–¥–∏
    // 18. –£ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å intervalId –∑–∞–ø–∏—Å—É—î–º–æ id —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É
    this.intervalId = setInterval(() => {
      // 6. –í—Å–µ—Ä–µ–¥–∏–Ω—ñ setInterval –∑–∞–ø–∏—Å—É—î–º–æ —É –∑–º—ñ–Ω–Ω—É –ø–æ—Ç–æ—á–Ω–∏–π —á–∞—Å, –∫–æ–ª–∏ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –±—É–¥–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏—Å—è
      const currentTime = Date.now();

      // 7. –†–∞—Ö—É—î–º–æ —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ –ø–æ—Ç–æ—á–Ω–∏–º —á–∞—Å–æ–º —ñ —Å—Ç–∞—Ä—Ç–æ–≤–∏–º (–≤—Å–µ—Ä–µ–¥–∏–Ω—ñ setInterval startTime –Ω–µ –∑–º—ñ–Ω–∏—Ç—å—Å—è, –≤—ñ–Ω –±–µ—Ä–µ—Ç—å—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –≤–∏–∫–ª–∏–∫—É –º–µ—Ç–æ–¥—É start)
      const deltaTime = currentTime - startTime;

      // 10. –ù–∞ –∫–æ–∂–Ω–æ–º—É —ñ–Ω—Ç–µ—Ä–≤–∞–ª—ñ –≤–∏–∫–ª–∏–∫–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é updateClockface —ñ –ø–µ—Ä–µ–¥–∞—î–º–æ —ó–π deltaTime
      updateClockface(deltaTime);
    }, 1000);
  },

  // 16. –î–æ–¥–∞—î–º–æ –º–µ—Ç–æ–¥ stop
  stop() {
    // 19. –û—á–∏—â—É—î–º–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª
    clearInterval(this.intervalId);
    // 20. –°–µ—Ç–∏–º–æ intervalId –Ω–∞–∑–∞–¥ –≤ null (—â–æ–± –≤—Å–µ –±—É–ª–æ –∫—Ä–∞—Å–∏–≤–æ)
    this.intervalId = null;
    // 25. –í–∫–∞–∑—É—î–º–æ, —â–æ –ø—ñ–¥ —á–∞—Å –∑—É–ø–∏–Ω–∫–∏ —Ç–∞–π–º–µ—Ä–∞ –≤—ñ–Ω –Ω–µ –∞–∫—Ç–∏–≤–Ω–∏–π (—â–æ–± –º–æ–∂–Ω–∞ –±—É–ª–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏)
    this.isActive = false;
    // 21. –ü–µ—Ä–µ–¥–∞—î–º–æ —É —Ñ—É–Ω–∫—Ü—ñ—é updateClockface —á–∞—Å 0, —â–æ–± –ø—Ä–∏ –∑—É–ø–∏–Ω—Ü—ñ —Ç–∞–π–º–µ—Ä–∞ –≤—ñ–Ω –æ–±–Ω—É–ª—é–≤–∞–≤—Å—è
    updateClockface(0);
  },
};

// 15. –î–æ–¥–∞—î–º–æ —Å–ª—É—Ö–∞—á—ñ –ø–æ–¥—ñ—ó 'click' –Ω–∞ –∫–Ω–æ–ø–∫–∏
//     –ü—Ä–∏ –∫–ª—ñ–∫—É –Ω–∞ –∫–æ–ø–∫—É "–ó–∞–ø—É—Å—Ç–∏—Ç–∏", –≤–∏–∫–ª–∏–∫–∞—î–º–æ start; –ø—Ä–∏ –∫–ª—ñ–∫—É –Ω–∞ "–ó—É–ø–∏–Ω–∏—Ç–∏" - stop
//     –ü—Ä–∏ –ø–µ—Ä–µ–¥–∞—á—ñ –º–µ—Ç–æ–¥—É —è–∫ callback –≤ –æ–±—Ä–æ–±–ª—é–≤–∞—á –ø–æ–¥—ñ—ó, –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø—Ä–∏–≤'—è–∑—É—î–º–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç
refs.startBtn.addEventListener('click', timer.start.bind(timer));
refs.stopBtn.addEventListener('click', timer.stop.bind(timer));

// 8. –°—Ç–≤–æ—Ä—é—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é, –ø–µ—Ä–µ–¥–∞—î–º–æ —ó–π time - –Ω–∞—à—ñ –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥–∏ (deltaTime)
function updateClockface(time) {
  //   /*
  //    * –ö–æ–ø—ñ–ø–∞—Å—Ç–∞ –∑—ñ —Å—Ç–µ–∫—É üí©
  //    */

  // 9. –ö–æ–ø—ñ—é—î–º–æ —É —Ñ—É–Ω–∫—Ü—ñ—é —Ñ–æ—Ä–º—É–ª–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É –≥–æ–¥–∏–Ω, —Ö–≤–∏–ª–∏–Ω —Ç–∞ —Å–µ–∫—É–Ω–¥ —ñ–∑ –Ω–∞—à–∏—Ö –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥ (—Ñ–æ—Ä–º—É–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –∑–∞–ª–∏—à–æ–∫ –≤—ñ–¥ –¥—ñ–ª–µ–Ω–Ω—è %)
  // 13. –î–ª—è –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—è —á–∞—Å—É –¥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É, –æ–±–≥–æ—Ç—Ä–∞—î–º–æ —Ñ–æ—Ä–º—É–ª–∏ —É –≤–∏–∫–ª–∏–∫ —Ñ—É–Ω–∫—Ü—ñ—ó pad
  const hours = pad(
    Math.floor((time % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)),
  );
  const mins = pad(Math.floor((time % (1000 * 60 * 60)) / (1000 * 60)));
  const secs = pad(Math.floor((time % (1000 * 60)) / 1000));

  // 14. –í—Å—Ç–∞–≤–ª—è—î–º–æ —á–∞—Å —è–∫ —Ç–µ–∫—Å—Ç–æ–≤–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤—Å–µ—Ä–µ–¥–∏–Ω—É –Ω–∞—à–æ–≥–æ –∞–±–∑–∞—Ü—É
  refs.clockface.textContent = `${hours}:${mins}:${secs}`;
}

// 11. –°—Ç–≤–æ—Ä—é—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é pad, —è–∫–∞ –±—É–¥–µ –ø—Ä–∏–≤–æ–¥–∏—Ç–∏ –Ω–∞—à —á–∞—Å –¥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É (–æ—Ç—Ä–∏–º—É—î–º–æ —á–∞—Å —É —Ñ–æ—Ä–º–∞—Ç—ñ 0:0:1, –∞ —Ö–æ—á–µ–º–æ 00:00:01)
function pad(value) {
  // 12. –ü—Ä–∏–≤–æ–¥–∏–º–æ —á–∏—Å–ª–æ –¥–æ —Ä—è–¥–∫–∞, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä String. –ù–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –≤–∏–∫–ª–∏–∫–∞—î–º–æ padStart —ñ –≤–∫–∞–∑—É—î–º–æ: —è–∫—â–æ –±—É–¥–µ –º–µ–Ω—à–µ 2-—Ö —Å–∏–º–≤–æ–ª—ñ–≤, "–¥–æ–±–∏—Ç–∏" –¥–æ 2-—Ö —Å–∏–º–≤–æ–ª—ñ–≤ –Ω—É–ª—è–º–∏ –∑—ñ —Å—Ç–∞—Ä—Ç—É
  return String(value).padStart(2, '0');
}
